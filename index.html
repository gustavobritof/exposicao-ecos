<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Museu Espacial VR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        /* Estilos do Painel de Informa√ß√µes (UI Overlay) */
        #info-panel {
            display: none;
            /* Come√ßa oculto */
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 300px;
            z-index: 1000;
        }

        /* Estilo espec√≠fico para quando estiver na cena 2 (futurista) */
        #info-panel.theme-dark {
            background: #f0f8ff;
            border: 2px solid #87ceeb;
            box-shadow: 0 4px 20px rgba(135, 206, 235, 0.5);
            right: 30px;
        }

        #panel-title {
            margin: 0 0 10px 0;
            color: #1976d2;
        }

        #info-panel.theme-dark #panel-title {
            color: #2c5f7f;
        }

        #panel-desc {
            margin: 0 0 15px 0;
            color: #333;
            line-height: 1.5;
        }

        #info-panel.theme-dark #panel-desc {
            color: #4a6b82;
        }

        #close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 16px;
        }

        #info-panel.theme-dark #close-btn {
            background: #87ceeb;
            color: #ffffff;
            width: 30px;
            height: 30px;
            font-weight: bold;
        }

        #action-btn {
            width: 100%;
            padding: 8px 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        #info-panel.theme-dark #action-btn {
            background: #87ceeb;
            color: #ffffff;
            font-weight: bold;
            padding: 10px 16px;
        }

        /* Bot√£o Voltar (Overlay) */
        #btn-voltar {
            display: none;
            position: absolute;
            top: 20px;
            left: 20px;
            background: #87ceeb;
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(135, 206, 235, 0.4);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        #btn-voltar:hover {
            background: #6bb3e0;
            box-shadow: 0 6px 20px rgba(135, 206, 235, 0.6);
            transform: scale(1.05);
        }
    </style>
</head>

<body>

    <!-- Bot√£o Voltar (HTML Overlay) -->
    <button id="btn-voltar">‚Üê VOLTAR</button>

    <!-- Overlay HTML (Painel de Info) -->
    <div id="info-panel">
        <button id="close-btn">√ó</button>
        <h3 id="panel-title">T√≠tulo</h3>
        <p id="panel-desc">Descri√ß√£o</p>
        <button id="action-btn">Ver em 3D</button>
    </div>

    <!-- Cena A-Frame -->
    <a-scene>
        <a-assets>
            <img id="skyTexture" src="/images/sky.jpg" alt="Sky Texture">
        </a-assets>

        <!-- C√¢mera e Cursor (Compartilhado) -->
        <a-entity id="rig" position="0 0 0">
            <a-camera position="0 1.6 0" look-controls="pointerLockEnabled: false">
                <a-cursor id="cursor" color="white" raycaster="objects: .clickable"></a-cursor>
                <!-- Anel extra para a cena 2 -->
                <a-ring id="cursor-ring" visible="false" color="#87ceeb" radius-inner="0.02" radius-outer="0.03"
                    position="0 0 -1" scale="0.01 0.01 0.01"></a-ring>
            </a-camera>
        </a-entity>

        <!-- ========================================== -->
        <!-- GRUPO 1: MUSEU (SCENE 1)                   -->
        <!-- ========================================== -->
        <a-entity id="scene-museum" visible="true">
            <!-- Ilumina√ß√£o do Museu -->
            <a-light type="ambient" color="#fff" intensity="0.6"></a-light>
            <a-light type="directional" color="#fff" intensity="0.8" position="5 10 5"></a-light>
            <a-light type="point" intensity="0.5" position="-5 3 -5" color="#ffe8cc"></a-light>
            <a-light type="point" intensity="0.5" position="5 3 -5" color="#ffe8cc"></a-light>
            <a-light type="point" intensity="0.5" position="0 3 0" color="#ffe8cc"></a-light>

            <!-- Ambiente -->
            <a-plane rotation="-90 0 0" width="50" height="50" color="#8b6f47" roughness="0.6" metalness="0.1" shadow></a-plane>
            <!-- Detalhes do ch√£o -->
            <a-plane rotation="-90 0 0" width="18" height="18" position="0 0.01 -1" color="#a0826d" roughness="0.5"></a-plane>
            <a-sky id="sky-museum" src="#skyTexture"></a-sky>
            <!-- Teto -->
            <a-plane rotation="90 0 0" width="22" height="22" position="0 5 -1" color="#f5f5dc" roughness="0.7"></a-plane>

            <!-- Paredes -->
            <a-box position="0 2.5 -10" width="20" height="5" depth="0.3" color="#e8dcc7" roughness="0.6" shadow></a-box>
            <!-- Moldura parede frontal -->
            <a-box position="0 4.8 -9.85" width="20" height="0.15" depth="0.1" color="#8b7355"></a-box>
            <a-box position="0 0.1 -9.85" width="20" height="0.15" depth="0.1" color="#8b7355"></a-box>
            
            <a-box position="-10 2.5 0" width="0.3" height="5" depth="20" color="#e8dcc7" roughness="0.6" shadow></a-box>
            <!-- Moldura parede esquerda -->
            <a-box position="-9.85 4.8 0" width="0.1" height="0.15" depth="20" color="#8b7355"></a-box>
            
            <a-box position="10 2.5 0" width="0.3" height="5" depth="20" color="#e8dcc7" roughness="0.6" shadow></a-box>
            <!-- Moldura parede direita -->
            <a-box position="9.85 4.8 0" width="0.1" height="0.15" depth="20" color="#8b7355"></a-box>

            <!-- Pinturas Decorativas -->
            <a-entity id="paintings-container"></a-entity>

            <!-- Exibi√ß√µes (Geradas via JS) -->
            <a-entity id="exhibits-container"></a-entity>

            <!-- Em Breve -->
            <a-entity position="5 0 0">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#2c3e50" roughness="0.5"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.2" depth="1" color="#34495e" roughness="0.3"></a-box>
                <a-plane position="-0.61 0.2 0" width="1" height="0.3" color="#ecf0f1" roughness="0.4"
                    rotation="0 -90 0"></a-plane>
                <a-text value="Em Breve" position="-0.61 0.2 0" align="center" anchor="center" color="#2c3e50"
                    rotation="0 -90 0"></a-text>
            </a-entity>
        </a-entity>

        <!-- ========================================== -->
        <!-- GRUPO 2: GALERIA DETALHE (SCENE 2)         -->
        <!-- ========================================== -->
        <a-entity id="scene-gallery" visible="false" position="100 0 0">
            <!-- Afastado para evitar z-fighting de luzes -->

            <!-- Ilumina√ß√£o Galeria -->
            <a-light type="ambient" intensity="0.4" color="#ffffff"></a-light>
            <a-light type="directional" intensity="0.4" position="3 4 3" color="#ffffff"></a-light>
            <a-light type="point" intensity="0.4" position="-5 2.5 -3" color="#e0f0ff"></a-light>
            <a-light type="point" intensity="0.4" position="5 2.5 -3" color="#e0f0ff"></a-light>

            <!-- Ambiente Galeria -->
            <a-sky color="#f0f8ff"></a-sky> <!-- Fundo branco gelo -->
            <a-plane color="#e8f4f8" rotation="-90 0 0" width="18" height="16" position="0 0 0" shadow></a-plane>
            <a-plane color="#d0e8f2" rotation="-90 0 0" width="8" height="8" position="0 0.01 0" shadow></a-plane>
            <a-plane color="#f5f9fc" rotation="90 0 0" width="18" height="16" position="0 3.8 0"></a-plane>
            <!-- Teto -->

            <!-- Estrutura Futurista (Paredes e Neon) -->
            <a-plane color="#ffffff" width="18" height="3.8" position="0 1.9 -8"></a-plane>
            <a-box color="#87ceeb" width="18" height="0.15" depth="0.1" position="0 3.7 -8.03"
                emissive="#87ceeb"></a-box>

            <a-plane color="#f5f9fc" width="16" height="3.8" position="-9 1.9 0" rotation="0 90 0"></a-plane>
            <a-box color="#87ceeb" width="16" height="0.1" depth="0.1" position="-9 3.75 0" rotation="0 90 0"
                emissive="#87ceeb"></a-box>

            <a-plane color="#f5f9fc" width="16" height="3.8" position="9 1.9 0" rotation="0 90 0"></a-plane>
            <a-box color="#87ceeb" width="16" height="0.1" depth="0.1" position="9 3.75 0" rotation="0 90 0"
                emissive="#87ceeb"></a-box>

            <!-- Pedestal Central -->
            <a-cylinder color="#e0e8f0" radius="0.85" height="0.5" position="0 0.0 -3" shadow></a-cylinder>
            <a-cylinder color="#87ceeb" radius="0.9" height="0.12" position="0 0.5 -3" shadow
                emissive="#87ceeb"></a-cylinder>

            <!-- MODELO DIN√ÇMICO (Ser√° preenchido pelo JS) -->
            <a-entity id="gallery-model-holder" position="0 1.2 -3">
                <!-- O modelo GLTF ser√° injetado aqui -->
            </a-entity>

            <!-- T√≠tulo Principal da Galeria -->
            <a-text id="gallery-main-title" value="" align="center" anchor="center" position="0 3 -7.8" color="#2c5f7f"
                font-size="48" width="20" font-weight="bold"></a-text>

            <!-- Colunas Futuristas -->
            <a-cylinder color="#87ceeb" radius="0.15" height="3.5" position="-7.5 1.75 -7.5" shadow
                emissive="#87ceeb"></a-cylinder>
            <a-cylinder color="#87ceeb" radius="0.15" height="3.5" position="7.5 1.75 -7.5" shadow
                emissive="#87ceeb"></a-cylinder>
            <a-box color="#87ceeb" width="16" height="0.04" depth="0.04" position="0 2.5 -7.95" shadow
                emissive="#87ceeb"></a-box>

            <!-- Pain√©is Est√°ticos da Galeria -->
            <!-- Esquerda -->
            <a-entity id="gallery-panel-historia" class="clickable gallery-panel" data-id="historia"
                position="-6.8 2.3 -3" rotation="0 15 0">
                <a-box color="#d8e9f3" width="2.8" height="2.3" depth="0.08" shadow></a-box>
                <a-text value="HISTORIA" position="0 -1.4 0" align="center" color="#2c5f7f" font-size="20" width="7"
                    font-weight="bold"></a-text>
            </a-entity>
            <a-entity id="gallery-panel-tecnologia" class="clickable gallery-panel" data-id="tecnologia"
                position="-6.8 2.3 3" rotation="0 15 0">
                <a-box color="#d8e9f3" width="2.8" height="2.3" depth="0.08" shadow></a-box>
                <a-text value="TECNOLOGIA" position="0 -1.4 0" align="center" color="#2c5f7f" font-size="20" width="7"
                    font-weight="bold"></a-text>
            </a-entity>

            <!-- Direita -->
            <a-entity id="gallery-panel-missoes" class="clickable gallery-panel" data-id="missoes" position="6.8 2.3 -3"
                rotation="0 -15 0">
                <a-box color="#d8e9f3" width="2.8" height="2.3" depth="0.08" shadow></a-box>
                <a-text value="MISSOES" position="0 -1.4 0" align="center" color="#2c5f7f" font-size="20" width="7"
                    font-weight="bold"></a-text>
            </a-entity>
            <a-entity id="gallery-panel-futuro" class="clickable gallery-panel" data-id="futuro" position="6.8 2.3 3"
                rotation="0 -15 0">
                <a-box color="#d8e9f3" width="2.8" height="2.3" depth="0.08" shadow></a-box>
                <a-text value="FUTURO" position="0 -1.4 0" align="center" color="#2c5f7f" font-size="20" width="7"
                    font-weight="bold"></a-text>
            </a-entity>

            
        </a-entity>

    </a-scene>

    <script>
        // ==========================================
        // DADOS
        // ==========================================
        const exhibitsData = [
            {
                id: 'hubble',
                pos: '-5 0 -5',
                model: '/models/hubble.glb',
                scale: '0.0003 0.0003 0.0003',
                label: 'üî≠ Hubble',
                labelPos: '0 0.2 0.61',
                labelRot: '0 0 0',
                title: 'Hubble Space Telescope',
                desc: 'O telesc√≥pio espacial Hubble revolucionou nossa vis√£o do universo.',
                duration: 10000,
            },
            {
                id: 'jwst',
                pos: '0 0 -5',
                model: '/models/jwst_james_webb_space_telescope.glb',
                scale: '0.05 0.05 0.05',
                label: 'JWST',
                labelPos: '0 0.2 0.61',
                labelRot: '0 0 0',
                title: 'James Webb Space Telescope',
                desc: 'O telesc√≥pio espacial mais avan√ßado, observando o universo em infravermelho.',
                duration: 10000,
            },
            {
                id: 'saturnv',
                pos: '5 0 -5',
                model: '/models/saturnVCorrect.glb',
                scale: '0.3 0.3 0.3',
                label: 'üöÄ Saturn V',
                labelPos: '0 0.2 0.61',
                labelRot: '0 0 0',
                title: 'Saturn V Rocket',
                desc: 'O foguete mais poderoso j√° constru√≠do, levou os astronautas √† Lua.',
                duration: 10000,
            },
            {
                id: 'iss',
                pos: '-5 0 0',
                model: '/models/ISS_Correct.glb',
                scale: '0.1 0.1 0.1',
                label: 'üåç ISS',
                labelPos: '0.61 0.2 0',
                labelRot: '0 90 0',
                title: 'International Space Station',
                desc: 'Laborat√≥rio orbital onde astronautas de v√°rios pa√≠ses trabalham.',
                duration: 10000,
            }
        ];

        const galleryInfoData = {
            'historia': { title: 'Hist√≥ria', desc: 'Uma jornada atrav√©s dos marcos mais importantes da explora√ß√£o humana do espa√ßo.' },
            'tecnologia': { title: 'Tecnologia', desc: 'Descubra as inova√ß√µes tecnol√≥gicas que tornaram poss√≠vel alcan√ßar as estrelas.' },
            'missoes': { title: 'Miss√µes', desc: 'Conhe√ßa as miss√µes que mudaram nossa compreens√£o do universo.' },
            'futuro': { title: 'Futuro', desc: 'Explore as possibilidades e desafios da pr√≥xima era de descobertas.' }
        };

        // Estado Global
        let currentScene = 'museum';
        let selectedExhibitData = null;
        let activeInfoItem = null;

        // Elementos DOM
        const infoPanel = document.getElementById('info-panel');
        const panelTitle = document.getElementById('panel-title');
        const panelDesc = document.getElementById('panel-desc');
        const closeBtn = document.getElementById('close-btn');
        const actionBtn = document.getElementById('action-btn');
        const cursor = document.getElementById('cursor');
        const btnVoltar = document.getElementById('btn-voltar');

        // ==========================================
        // INICIALIZA√á√ÉO
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            initPaintings();
            initMuseumExhibits();
            setupUIInteractions();
            setupGalleryInteractions();
        });

        // ==========================================
        // FUN√á√ïES DE CRIA√á√ÉO (MUSEU)
        // ==========================================
        function initPaintings() {
            const container = document.getElementById('paintings-container');
            const paintings = [
                { pos: '-7 3 -9.85', color: '#c9302c', frame: '#4a2c2a' },
                { pos: '-3.5 3 -9.85', color: '#2980b9', frame: '#1a4d6d' },
                { pos: '0 3 -9.85', color: '#f39c12', frame: '#8b5a00' },
                { pos: '3.5 3 -9.85', color: '#27ae60', frame: '#1e5631' },
                { pos: '7 3 -9.85', color: '#8e44ad', frame: '#5b2c6f' }
            ];

            paintings.forEach(p => {
                // Moldura
                const frame = document.createElement('a-box');
                frame.setAttribute('position', p.pos);
                frame.setAttribute('width', '1.8');
                frame.setAttribute('height', '2.2');
                frame.setAttribute('depth', '0.1');
                frame.setAttribute('color', p.frame);
                frame.setAttribute('roughness', '0.4');
                container.appendChild(frame);

                // Pintura
                const painting = document.createElement('a-box');
                painting.setAttribute('position', `${p.pos.split(' ')[0]} ${p.pos.split(' ')[1]} ${parseFloat(p.pos.split(' ')[2]) + 0.06}`);
                painting.setAttribute('width', '1.5');
                painting.setAttribute('height', '1.9');
                painting.setAttribute('depth', '0.05');
                painting.setAttribute('color', p.color);
                painting.setAttribute('roughness', '0.2');
                painting.setAttribute('metalness', '0.1');
                container.appendChild(painting);
            });
        }

        function initMuseumExhibits() {
            const container = document.getElementById('exhibits-container');

            exhibitsData.forEach(item => {
                const wrapper = document.createElement('a-entity');
                wrapper.setAttribute('position', item.pos);

                // Base
                wrapper.innerHTML = `
                    <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4" shadow></a-box>
                    <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50" roughness="0.3"></a-box>
                    <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2" metalness="0.3"></a-box>
                `;

                // Modelo
                const modelEl = document.createElement('a-entity');
                modelEl.setAttribute('gltf-model', item.model);
                modelEl.setAttribute('position', '0 2 0');
                modelEl.setAttribute('scale', item.scale);
                modelEl.setAttribute('class', 'clickable');
                modelEl.setAttribute('animation', `property: rotation; to: 0 360 0; loop: true; dur: ${item.duration}; easing: linear`);

                // Intera√ß√µes Mouse (Hover Scale)
                modelEl.addEventListener('mouseenter', () => {
                    cursor.setAttribute('color', 'green');
                    const [x, y, z] = item.scale.split(' ').map(parseFloat);
                    modelEl.setAttribute('scale', `${x * 1.1} ${y * 1.1} ${z * 1.1}`);
                });

                modelEl.addEventListener('mouseleave', () => {
                    cursor.setAttribute('color', 'white');
                    modelEl.setAttribute('scale', item.scale);
                });

                modelEl.addEventListener('click', () => {
                    showInfoPanel(item, 'museum');
                });

                wrapper.appendChild(modelEl);

                // Label
                const labelGroup = document.createElement('a-entity');
                labelGroup.innerHTML = `
                    <a-plane position="${item.labelPos}" width="1" height="0.3" color="#ecf0f1" roughness="0.4" rotation="${item.labelRot}"></a-plane>
                    <a-text value="${item.label}" position="${item.labelPos}" align="center" anchor="center" color="#2c3e50" rotation="${item.labelRot}"></a-text>
                `;
                wrapper.appendChild(labelGroup);

                container.appendChild(wrapper);
            });
        }

        // ==========================================
        // UI & L√ìGICA DE TROCA
        // ==========================================
        function showInfoPanel(data, context) {
            activeInfoItem = data;

            // Preencher HTML
            panelTitle.textContent = data.title;
            panelDesc.textContent = data.desc;
            infoPanel.style.display = 'block';

            if (context === 'museum') {
                // Modo Museu
                infoPanel.className = '';
                actionBtn.textContent = 'Ver em 3D';
                actionBtn.onclick = () => switchToGallery(data);
                actionBtn.style.display = 'block';
            } else {
                // Modo Galeria (Pain√©is est√°ticos)
                infoPanel.className = 'theme-dark';
                actionBtn.textContent = 'Saber Mais';
                actionBtn.onclick = () => alert('Funcionalidade extra aqui!');
            }
        }
        function setupUIInteractions() {
            closeBtn.addEventListener('click', () => {
                infoPanel.style.display = 'none';
                activeInfoItem = null;
            });

            // Bot√£o Voltar HTML
            btnVoltar.addEventListener('click', switchToMuseum);
        }

        // ==========================================
        // L√ìGICA DE TRANSI√á√ÉO DE CENAS
        // ==========================================
        function switchToGallery(exhibitData) {
            selectedExhibitData = exhibitData;
            infoPanel.style.display = 'none'; // Fecha o painel

            // 1. Troca Visibilidade dos Grupos
            document.getElementById('scene-museum').setAttribute('visible', 'false');

            const galleryScene = document.getElementById('scene-gallery');
            galleryScene.setAttribute('visible', 'true');
            // Mover a c√¢mera/rig para a posi√ß√£o da galeria (offset de 100 em X)
            document.getElementById('rig').setAttribute('position', '100 0 0');

            // 2. Configura o Modelo na Galeria
            const holder = document.getElementById('gallery-model-holder');
            holder.innerHTML = ''; // Limpa anterior

            const modelEl = document.createElement('a-entity');
            modelEl.setAttribute('gltf-model', exhibitData.model);

            // Usa a escala original ou ajusta se necess√°rio
            modelEl.setAttribute('scale', exhibitData.scale);
            modelEl.setAttribute('animation', `property: rotation; to: 0 360 0; loop: true; dur: ${exhibitData.duration}; easing: linear`);
            modelEl.setAttribute('shadow', '');

            holder.appendChild(modelEl);

            // 3. Atualiza T√≠tulo
            document.getElementById('gallery-main-title').setAttribute('value', exhibitData.title);

            // 4. Cursor Estilo Galeria
            document.getElementById('cursor-ring').setAttribute('visible', 'true');

            // 5. Mostra bot√£o voltar HTML
            btnVoltar.style.display = 'block';

            currentScene = 'detail';
        }

        function switchToMuseum() {
            infoPanel.style.display = 'none';
            selectedExhibitData = null;

            // 1. Troca Visibilidade
            document.getElementById('scene-gallery').setAttribute('visible', 'false');
            document.getElementById('scene-museum').setAttribute('visible', 'true');

            // 2. Reseta Posi√ß√£o
            document.getElementById('rig').setAttribute('position', '0 0 0');

            // 3. Reseta Cursor
            document.getElementById('cursor-ring').setAttribute('visible', 'false');

            // 4. Esconde bot√£o voltar HTML
            btnVoltar.style.display = 'none';

            currentScene = 'museum';
        }

        function setupGalleryInteractions() {
            // Configurar bot√£o voltar
            const btnBack = document.getElementById('btn-back');
            btnBack.addEventListener('mouseenter', () => cursor.setAttribute('color', '#87ceeb'));
            btnBack.addEventListener('mouseleave', () => cursor.setAttribute('color', 'white'));
            btnBack.addEventListener('click', switchToMuseum);

            // Configurar pain√©is informativos da galeria
            const panels = document.querySelectorAll('.gallery-panel');
            panels.forEach(panel => {
                panel.addEventListener('mouseenter', () => cursor.setAttribute('color', '#87ceeb'));
                panel.addEventListener('mouseleave', () => cursor.setAttribute('color', 'white'));

                panel.addEventListener('click', (e) => {
                    // Pega o ID (historia, tecnologia, etc)
                    // Como o click pode vir do filho (box/text), pegamos o closest
                    const target = e.target.closest('.gallery-panel');
                    const id = target.getAttribute('data-id');

                    if (galleryInfoData[id]) {
                        showInfoPanel(galleryInfoData[id], 'gallery');
                    }
                });
            });
        }

    </script>
</body>

</html>