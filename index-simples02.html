<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Museu Espacial VR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-orbit-controls@1.3.2/dist/aframe-orbit-controls.min.js"></script>
    <script src="sceneManager.js"></script>

    <!-- Componente para texto curvo -->
    <script>
        AFRAME.registerComponent('curved-text', {
            schema: {
                value: { type: 'string', default: '' },
                radius: { type: 'number', default: 5 },
                arc: { type: 'number', default: 30 },
                color: { type: 'color', default: '#000000' },
                fontSize: { type: 'number', default: 0.3 }
            },
            init: function () {
                const data = this.data;
                const text = data.value;
                const numChars = text.length;
                const angleStep = (data.arc * Math.PI / 180) / (numChars - 1 || 1);
                const startAngle = -(data.arc * Math.PI / 180) / 2;

                for (let i = 0; i < numChars; i++) {
                    const char = text[i];
                    if (char === ' ') continue;

                    const angle = startAngle + (i * angleStep);
                    const x = Math.sin(angle) * data.radius;
                    const z = -Math.cos(angle) * data.radius;
                    const rotationY = -angle * (180 / Math.PI);

                    const charEntity = document.createElement('a-text');
                    charEntity.setAttribute('value', char);
                    charEntity.setAttribute('position', `${x} 0 ${z}`);
                    charEntity.setAttribute('rotation', `0 ${rotationY} 0`);
                    charEntity.setAttribute('color', data.color);
                    charEntity.setAttribute('align', 'center');
                    charEntity.setAttribute('anchor', 'center');
                    charEntity.setAttribute('width', data.fontSize * 10);
                    charEntity.setAttribute('baseline', 'center');

                    this.el.appendChild(charEntity);
                }
            }
        });
    </script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            transition: opacity 0.8s ease-in-out;
            opacity: 0;
            /* Começa invisível para o fade-in do load */
            background-color: black;
            /* Fundo preto ajuda na transição */
        }

        #dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        #dialog-content {
            background-color: #e8dcc7;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(139, 115, 85, 0.5);
        }

        #dialog-content h2 {
            color: #2c5f7f;
            margin-top: 0;
        }

        #dialog-content p {
            color: #2c3e50;
            line-height: 1.6;
        }

        #close-dialog {
            background-color: #8b7355;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }

        #close-dialog:hover {
            background-color: #2c5f7f;
        }
    </style>
</head>

<body>
    <h1 id="cena-titulo">Cena 2</h1>

    <!-- Overlay para diálogos expansíveis -->
    <div id="dialog-overlay">
        <div id="dialog-content">
            <h2 id="dialog-title"></h2>
            <p id="dialog-text"></p>
            <button id="close-dialog">Fechar</button>
        </div>
    </div>

    <a-scene id="scene02" shadow="type: pcfs">
        <a-assets>
            <a-asset-item id="hubble-asset" src="models/hubble.glb"></a-asset-item>
            <a-asset-item id="voyager-asset" src="models/Voyager 1.glb"></a-asset-item>


            <img src="images/ceu-noturno-estrelado-azul-e-branco.jpg" id="sky">
            <!-- Imagens mockup para os painéis -->
            <img src="images/background.jpg" id="panel-historia-img" crossorigin="anonymous">
            <img src="images/background.jpg" id="panel-tecnologia-img" crossorigin="anonymous">
            <img src="images/background.jpg" id="panel-missoes-img" crossorigin="anonymous">
            <img src="images/background.jpg" id="panel-futuro-img" crossorigin="anonymous">
        </a-assets>


        <a-camera position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-camera>

        <!-- Iluminação Galeria -->
        <a-light type="ambient" intensity="0.1" color="#ffffff"></a-light>
        <a-light type="directional" intensity="0.4" position="3 4 3" color="#ffffff"></a-light>
        <a-light type="point" intensity="0.4" position="-5 2.5 -3" color="#e0f0ff"></a-light>
        <!-- <a-light type="point" intensity="0.4" position="5 2.5 -3" color="#e0f0ff"></a-light> -->

        <!-- Ambiente Galeria (Sala Menor Semi-circular) -->
        <a-sky src="#sky" animation="property: rotation; to: 0 360 0; loop: true; dur: 240000; easing: linear"></a-sky>
        <!-- Chão circular -->
        <a-circle color="#8b6f47" radius="5" rotation="-90 0 0" position="0 0 -2" shadow></a-circle>
        <a-circle color="#a0826d" radius="3" rotation="-90 0 0" position="0 0.01 -2" shadow></a-circle>
        <!-- Teto -->
        <a-circle color="#e8dcc7" radius="5" rotation="90 0 0" position="0 3.2 -2"></a-circle>

        <!-- Parede de fundo curva (semi-círculo) -->
        <a-curvedimage src="" height="3.2" radius="5" theta-length="180" rotation="0 0 0" position="0 1.6 -2"
            material="color: #e8dcc7; side: double"></a-curvedimage>
        <a-curvedimage src="" height="1" width="5" radius="5" theta-length="180" theta-start="180" rotation="0 0 0"
            position="0 0.5 -2" material="color: #e8dcc7; side: double"></a-curvedimage>
        <!-- Cerca decorativa circular -->
        <!-- Anel horizontal da cerca -->
        <a-torus color="#8b7355" radius="3" radius-tubular="0.05" position="0 0.5 -2" rotation="90 0 0"
            emissive="#8b7355" emissive-intensity="0.3"></a-torus>

        <!-- Postes verticais da cerca (distribuídos ao redor) -->
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="3 0.3 -2" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="2.12 0.3 -4.12" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="0 0.3 -5" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="-2.12 0.3 -4.12" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="-3 0.3 -2" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="-2.12 0.3 0.12" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="0 0.3 1" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.05" height="0.6" position="2.12 0.3 0.12" emissive="#8b7355"
            emissive-intensity="0.2"></a-cylinder>


        <!-- Moldura superior curva -->
        <a-torus color="#8b7355" radius="5" radius-tubular="0.08" position="0 3.1 -2" rotation="90 0 0"
            emissive="#8b7355" emissive-intensity="0.3"></a-torus>


        <!-- Pedestal no canto -->
        <a-cylinder color="#8b7355" radius="0.6" height="0.4" position="-4 0.0 -2" shadow></a-cylinder>
        <a-cylinder color="#8b7355" radius="0.65" height="0.1" position="-4 0.4 -2" shadow
            emissive="#8b7355"></a-cylinder>
        <!-- MODELO 3D DINÂMICO no canto -->
        <a-entity id="dynamic-model-pedestal" position="-4 0.7 -2" scale="0.004 0.004 0.004" rotation="0 45 0"
            cursor-hover animation="property: rotation; to: 0 360 45; loop: true; dur: 8000; easing: linear">
        </a-entity>

        <!-- Título Principal da Galeria com Placa Arredondada -->
        <a-entity position="4.24 2.91 -1.96" rotation="0 -90 0">
            <a-box color="#8b7355" width="4.5" height="0.45" depth="0.08" opacity="0.9" geometry=""
                material="side: double" curved-text="color: #ad0000" visible=""></a-box>
            <a-text id="gallery-main-title" align=" center" anchor="center" position="0 0 0.08" color="#ffffff"
                font-size="24" width="9" font-weight="bold" text="width: 6.45;"></a-text>
        </a-entity>

        <!-- Painéis Temáticos Curvos na Parede -->
        <!-- História (esquerda) -->
        <a-entity id="gallery-panel-historia" class="clickable gallery-panel" data-id="historia" position="0 1.6 -2"
            rotation="0 142 0">
            <a-curvedimage src="#panel-historia-img" height="1.2" radius="4.8" theta-length="35"
                opacity="0.95"></a-curvedimage>
        </a-entity>
        <a-entity position="0 2.5 -2.16" rotation="0 -20 0" id="CurvedHistoria"
            curved-text="value: HISTORIA; radius: 4.75; arc: 30; ; fontSize: 0.25"></a-entity>

        <!-- Tecnologia (centro-esquerda) -->
        <a-entity id="gallery-panel-tecnologia" class="clickable gallery-panel" data-id="tecnologia" position="0 1.6 -2"
            rotation="0 98 0" cursor-hover>
            <a-curvedimage src="#panel-tecnologia-img" height="1.2" radius="4.8" theta-length="35"
                opacity="0.95"></a-curvedimage>
        </a-entity>
        <a-entity position="0 2.5 -2.36" rotation="0 -67 0" id="CurvedTecnologia"
            curved-text="value: TECNOLOGIA; radius: 4.75; arc: 30; ; fontSize: 0.25"></a-entity>

        <!-- Missões (centro-direita) -->
        <a-entity id="gallery-panel-missoes" class="clickable gallery-panel" data-id="missoes" position="0 1.6 -2"
            rotation="0 44 0">
            <a-curvedimage src="#panel-missoes-img" height="1.2" radius="4.8" theta-length="35"
                opacity="0.95"></a-curvedimage>
        </a-entity>
        <a-entity position="0 2.5 -1.66" rotation="0 -114 0" id="CurvedMissoes"
            curved-text="value: MISSOES; radius: 4.75; arc: 30; ; fontSize: 0.25"></a-entity>

        <!-- Futuro (direita) -->
        <a-entity id="gallery-panel-futuro" class="clickable gallery-panel" data-id="futuro" position="0 1.6 -2"
            rotation="0 1.37 0">
            <a-curvedimage src="#panel-futuro-img" height="1.2" radius="4.8" theta-length="35"
                opacity="0.95"></a-curvedimage>
        </a-entity>
        <a-entity position="0 2.5 -1.79" rotation="0 -160 0" id="CurvedFuturo"
            curved-text="value: FUTURO; radius: 4.75; arc: 30; ; fontSize: 0.25"></a-entity>

        <!-- <a-entity position="0 1.6 -2" scale="0.5 0.5 0.5">
            <a-box id="go-to-scene3" color="#ff6600" width="2" height="0.8" depth="0.2"
                material="emissive: #ff6600; emissiveIntensity: 0.5;"></a-box>
            <a-text value="Visualizar Modelo 3D" position="0 0 0.15" align="center" anchor="center" color="#ffffff"
                font-size="30"></a-text>
        </a-entity> -->

    </a-scene>


    <script>
        // Recupera o modelo selecionado e renderiza
        window.addEventListener('load', () => {
            const modelType = sessionStorage.getItem('modeloExibicao') || 'hubble';
            const configStr = sessionStorage.getItem('modeloConfig');
            const config = configStr ? JSON.parse(configStr) : { scale: '0.005 0.005 0.005', rotation: '0 0 0' };

            const dynamicModel = document.getElementById('dynamic-model-pedestal');

            // Map de modelos para IDs dos assets
            const modelMap = {
                'hubble': 'hubble-asset',
                'voyager': 'voyager-asset',
                'jwst': 'jwst-asset',
                'saturnv': 'saturnv-asset',
                'iss': 'iss-asset'
            };

            const assetId = modelMap[modelType];
            if (assetId) {
                dynamicModel.setAttribute('gltf-model', `#${assetId}`);
                dynamicModel.setAttribute('scale', config.scale);
                dynamicModel.setAttribute('rotation', config.rotation);
            }

            // Atualiza título da galeria
            const titles = {
                'hubble': 'TELESCÓPIO HUBBLE',
                'voyager': 'SONDA VOYAGER 1',
                'jwst': 'JAMES WEBB SPACE TELESCOPE',
                'saturnv': 'FOGUETE SATURN V',
                'iss': 'ESTAÇÃO ESPACIAL INTERNACIONAL'
            };

            document.getElementById('gallery-main-title').setAttribute('value', titles[modelType] || 'MUSEU ESPACIAL');
        });

        // Sistema de Diálogos Expansíveis
        const dialogContent = {
            historia: {
                hubble: {
                    title: 'História do Telescópio Hubble',
                    text: 'Lançado em 1990 pela NASA e ESA, o Telescópio Espacial Hubble revolucionou nossa compreensão do universo. Nomeado em homenagem ao astrônomo Edwin Hubble, este observatório orbital tem fornecido imagens incríveis do cosmos por mais de três décadas, revelando galáxias distantes, nebulosas coloridas e ajudando a determinar a idade do universo.'
                },
                voyager: {
                    title: 'História da Voyager 1',
                    text: 'Lançada em 5 de setembro de 1977, a Voyager 1 é uma das missões mais bem-sucedidas da NASA. Projetada para estudar Júpiter e Saturno, superou todas as expectativas ao se tornar o primeiro objeto feito pelo homem a entrar no espaço interestelar em 2012. Carrega o famoso Disco de Ouro com sons e imagens da Terra.'
                },
                jwst: {
                    title: 'História do James Webb',
                    text: 'O Telescópio Espacial James Webb foi lançado em 25 de dezembro de 2021, após décadas de desenvolvimento. Sucessor espiritual do Hubble, o JWST observa principalmente no infravermelho, permitindo ver através de poeira cósmica e observar as primeiras galáxias formadas após o Big Bang.'
                },
                saturnv: {
                    title: 'História do Saturn V',
                    text: 'O Saturn V foi o foguete mais poderoso já construído quando entrou em operação em 1967. Desenvolvido pela NASA sob a direção de Wernher von Braun, foi crucial para o programa Apollo, levando astronautas à Lua entre 1969 e 1972. Com 110 metros de altura, permanece como símbolo da era espacial.'
                },
                iss: {
                    title: 'História da Estação Espacial Internacional',
                    text: 'A construção da ISS começou em 1998 como projeto cooperativo entre NASA, Roscosmos, ESA, JAXA e CSA. É o maior objeto já construído no espaço e tem abrigado continuamente humanos desde novembro de 2000, servindo como laboratório de microgravidade e observatório astronômico.'
                }
            },
            tecnologia: {
                hubble: {
                    title: 'Tecnologia do Hubble',
                    text: 'O Hubble possui um espelho primário de 2.4 metros e instrumentos científicos avançados como câmeras CCD, espectrógrafos e sensores infravermelhos. Orbita a 547 km de altitude, completando uma volta na Terra a cada 95 minutos. Suas missões de manutenção por ônibus espaciais permitiram atualizações tecnológicas constantes.'
                },
                voyager: {
                    title: 'Tecnologia da Voyager',
                    text: 'A Voyager 1 é alimentada por três geradores termoelétricos de radioisótopos (RTGs) que convertem calor de plutônio-238 em eletricidade. Possui antena parabólica de 3.7 metros para comunicação com a Terra. Seus instrumentos incluem câmeras, espectrômetros e detectores de partículas carregadas.'
                },
                jwst: {
                    title: 'Tecnologia do James Webb',
                    text: 'O JWST possui um espelho primário segmentado de 6.5 metros coberto com ouro, otimizado para observações infravermelhas. Seu protetor solar do tamanho de uma quadra de tênis mantém os instrumentos a -233°C. Posicionado no ponto Lagrange L2, a 1.5 milhão de km da Terra.'
                },
                saturnv: {
                    title: 'Tecnologia do Saturn V',
                    text: 'O Saturn V tinha três estágios: S-IC com cinco motores F-1 queimando querosene e oxigênio líquido, S-II com cinco motores J-2 usando hidrogênio e oxigênio líquidos, e S-IVB com um motor J-2. Podia lançar até 140 toneladas para órbita baixa da Terra ou 48 toneladas para a Lua.'
                },
                iss: {
                    title: 'Tecnologia da ISS',
                    text: 'A ISS tem painéis solares que geram 120 kW de energia, módulos pressurizados para habitação e pesquisa, braços robóticos para manipulação externa e sistemas de suporte à vida que reciclam água e ar. Viaja a 28.000 km/h a 400 km de altitude, orbitando a Terra 16 vezes por dia.'
                }
            },
            missoes: {
                hubble: {
                    title: 'Missões do Hubble',
                    text: 'O Hubble realizou observações cruciais incluindo: medição precisa da expansão do universo, descoberta de energia escura, imagens profundas revelando milhares de galáxias, estudos de buracos negros supermassivos, análise de atmosferas de exoplanetas e captura de imagens icônicas como os Pilares da Criação.'
                },
                voyager: {
                    title: 'Missões da Voyager',
                    text: 'A Voyager 1 sobrevoou Júpiter em 1979, descobrindo anéis e luas vulcânicas, depois Saturno em 1980. Continuou sua jornada para o espaço interestelar, enviando dados sobre o meio interestelar. Ainda transmite informações a mais de 24 bilhões de km da Terra.'
                },
                jwst: {
                    title: 'Missões do James Webb',
                    text: 'O JWST está observando as primeiras galáxias formadas após o Big Bang, estudando a formação estelar e planetária, analisando atmosferas de exoplanetas em busca de sinais de habitabilidade, e produzindo imagens infravermelhas profundas nunca antes vistas.'
                },
                saturnv: {
                    title: 'Missões do Saturn V',
                    text: 'O Saturn V foi usado em 13 lançamentos, incluindo Apollo 8 (primeira missão tripulada à órbita lunar), Apollo 11 (primeiro pouso lunar), e todas as missões Apollo subsequentes. Também lançou a estação espacial Skylab em 1973.'
                },
                iss: {
                    title: 'Missões da ISS',
                    text: 'A ISS serve como plataforma para pesquisas em biologia, física, astronomia e meteorologia. Experimentos incluem crescimento de cristais, comportamento de fluidos em microgravidade, efeitos de longo prazo do espaço no corpo humano e testes de tecnologias para missões futuras.'
                }
            },
            futuro: {
                hubble: {
                    title: 'Futuro do Hubble',
                    text: 'O Hubble continua operacional, mas sua órbita gradualmente decai. Sem missões de manutenção planejadas, espera-se que funcione até meados dos anos 2030. Seu legado continuará através do James Webb e futuros telescópios espaciais que ele inspirou.'
                },
                voyager: {
                    title: 'Futuro da Voyager',
                    text: 'A Voyager 1 continuará enviando dados enquanto sua energia durar, provavelmente até 2025-2030. Depois, seguirá em silêncio pelo espaço interestelar. Em cerca de 40.000 anos, passará a 1.6 anos-luz da estrela Gliese 445.'
                },
                jwst: {
                    title: 'Futuro do James Webb',
                    text: 'O JWST tem combustível para operar por mais de 20 anos. Continuará revolucionando nossa compreensão do universo primitivo, sistemas planetários e a busca por vida extraterrestre. Seus dados serão estudados por décadas.'
                },
                saturnv: {
                    title: 'Futuro do Saturn V',
                    text: 'Embora aposentado em 1973, o Saturn V inspirou o desenvolvimento do SLS (Space Launch System) da NASA. Suas tecnologias e lições de engenharia continuam influenciando o design de foguetes pesados modernos para exploração espacial profunda.'
                },
                iss: {
                    title: 'Futuro da ISS',
                    text: 'A ISS está planejada para operar até pelo menos 2030. Após isso, será desorbitalizada de forma controlada. Estações futuras incluem projetos comerciais como Axiom Station e Gateway lunar, que aplicarão conhecimentos adquiridos na ISS.'
                }
            }
        };

        const overlay = document.getElementById('dialog-overlay');
        const dialogTitle = document.getElementById('dialog-title');
        const dialogText = document.getElementById('dialog-text');
        const closeBtn = document.getElementById('close-dialog');

        // Adicionar eventos de clique nos painéis
        document.querySelectorAll('.gallery-panel').forEach(panel => {
            panel.addEventListener('click', () => {
                const panelId = panel.getAttribute('data-id');
                const modelType = sessionStorage.getItem('modeloExibicao') || 'hubble';

                if (dialogContent[panelId] && dialogContent[panelId][modelType]) {
                    const content = dialogContent[panelId][modelType];
                    dialogTitle.textContent = content.title;
                    dialogText.textContent = content.text;
                    overlay.style.display = 'flex';
                }
            });
        });

        // Fechar diálogo
        closeBtn.addEventListener('click', () => {
            overlay.style.display = 'none';
        });

        // Fechar ao clicar fora do conteúdo
        overlay.addEventListener('click', (e) => {
            if (e.target === overlay) {
                overlay.style.display = 'none';
            }
        });
    </script>






</body>

</html>