<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Museu Espacial VR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-orbit-controls@1.3.2/dist/aframe-orbit-controls.min.js"></script>
    <script src="sceneManager.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            transition: opacity 0.8s ease-in-out;
            opacity: 0;
            /* Come√ßa invis√≠vel para o fade-in do load */
            background-color: black;
            /* Fundo preto ajuda na transi√ß√£o */
        }
    </style>
    <script>
        // // // COMPONENTE Faz o √≠cone e o painel sempre encararem o usu√°rio
        // AFRAME.registerComponent('billboard', {
        //     tick: function () {
        //         var camera = this.el.sceneEl.camera;
        //         if (camera) {
        //             this.el.object3D.lookAt(camera.el.object3D.position);
        //         }
        //     }
        // });

        // FUN√á√ÉO PARA FECHAR PAIN√âIS: Limpa os containers e mostra os √≠cones de volta
        function hideAllInfoPanels() {
            const containers = document.querySelectorAll("[id^=infoPanelContainer]");
            containers.forEach((container) => {
                container.innerHTML = ""; // Remove o conte√∫do do template
                const hotspotIcon = container.previousElementSibling;
                if (hotspotIcon) hotspotIcon.setAttribute("visible", true); // Mostra o bot√£o azul
            });
        }
    </script>
</head>

<body>

    <a-scene stats id="scene01">

        <a-assets>
            <img id="skyTexture" src="/images/sky.jpg">
            <a-asset-item id="hubble-model" src="/models/hubble.glb"></a-asset-item>
            <a-asset-item id="jwst-model" src="/models/jwst_james_webb_space_telescope.glb"></a-asset-item>
            <a-asset-item id="saturnv-model" src="/models/saturnV.glb"></a-asset-item>
            <a-asset-item id="iss-model" src="/models/ISS_Correct.glb"></a-asset-item>
            <a-asset-item id="voyager-model" src="/models/Voyager 1.glb"></a-asset-item>
            <img id="hotspot-img" src="images/HotspotIcon.png">
            <img id="crossIcon" src="https://coddmac.store/THREE/360/cross-icon.svg">
            <!-- TEMPLATE 1: HUBBLE -->

            <template id="infoPanel1">
                <a-entity rotation="0 45 0">
                    <a-plane color="#1a1a1a" height="1.5" width="2.5" position="1.79222 1.2 -0.0711"
                        rotation="0 -16.71 0" material="side: double">
                        <a-text
                            value="TELESCOPIO HUBBLE\n\nLancado em 1990, ele revolucionou a astronomia ao capturar imagens sem a distorcao da atmosfera terrestre."
                            align="center" width="2.2" position="0 0.2 0.01" text=""></a-text>
                        <a-image id="close-btn" src="#crossIcon" class="clickable" position="1.1 0.6 0.001" width="0.25"
                            height="0.25" material="" geometry=""></a-image>
                        <a-box id="view-hubble-btn" position="0 -0.5 0.05" width="1.8" height="0.3" depth="0.05"
                            color="#ff6600" material="emissive: #ff6600; emissiveIntensity: 0.5;"></a-box>
                        <a-text value="Ver Hubble em 3D" position="0 -0.5 0.1" align="center" anchor="center"
                            color="#ffffff" font-size="20"></a-text>
                    </a-plane>
                </a-entity>
            </template>

            <!-- TEMPLATE 2: VOYAGER -->
            <template id="infoPanel2">
                <a-entity>
                    <a-plane color="#1a1a1a" height="1.5" width="2.5" position="0 1.2 0" material="opacity: 1">
                        <a-text
                            value="SONDA VOYAGER 1\n\nO objeto humano mais distante da Terra. Atualmente viaja pelo espaco interestelar."
                            align="center" width="2.2" position="0 0.2 0.01"></a-text>
                        <a-image id="close-btn" src="#crossIcon" class="clickable" position="1.1 0.6 0.001" width="0.25"
                            height="0.25"></a-image>
                        <a-box id="view-voyager-btn" position="0 -0.5 0.05" width="1.8" height="0.3" depth="0.05"
                            color="#ff6600" material="emissive: #ff6600; emissiveIntensity: 0.5;"></a-box>
                        <a-text value="Ver Voyager em 3D" position="0 -0.5 0.1" align="center" anchor="center"
                            color="#ffffff" font-size="20"></a-text>
                    </a-plane>
                </a-entity>
            </template>
        </a-assets>

        </a-assets>
        <a-sky src="#skyTexture"></a-sky>
        <a-camera position="0 1.6 0" cursor="rayOrigin: mouse">
            <a-cursor></a-cursor>
        </a-camera>

        <a-light type="ambient" color="#fff" intensity="0.6"></a-light>
        <a-light type="directional" color="#fff" intensity="0.8" position="5 10 5"></a-light>
        <a-light type="point" intensity="0.5" position="-5 3 -5" color="#ffe8cc"></a-light>
        <a-light type="point" intensity="0.5" position="5 3 -5" color="#ffe8cc"></a-light>
        <a-light type="point" intensity="0.5" position="0 3 0" color="#ffe8cc"></a-light>

        <!-- Ambiente -->
        <a-plane rotation="-90 0 0" width="50" height="50" color="#8b6f47" roughness="0.6" metalness="0.1"
            shadow></a-plane>
        <!-- Detalhes do ch√£o -->
        <a-plane rotation="-90 0 0" width="18" height="18" position="0 0.01 -1" color="#a0826d"
            roughness="0.5"></a-plane>
        <a-sky id="sky-museum" src="#skyTexture"></a-sky>
        <!-- Teto -->
        <a-plane rotation="90 0 0" width="22" height="22" position="0 5 -1" color="#f5f5dc" roughness="0.7"></a-plane>

        <!-- Paredes -->
        <a-box position="0 2.5 -10" width="20" height="5" depth="0.3" color="#e8dcc7" roughness="0.6" shadow></a-box>
        <!-- Moldura parede frontal -->
        <a-box position="0 4.8 -9.85" width="20" height="0.15" depth="0.1" color="#8b7355"></a-box>
        <a-box position="0 0.1 -9.85" width="20" height="0.15" depth="0.1" color="#8b7355"></a-box>

        <a-box position="-10 2.5 0" width="0.3" height="5" depth="20" color="#e8dcc7" roughness="0.6" shadow></a-box>
        <!-- Moldura parede esquerda -->
        <a-box position="-9.85 4.8 0" width="0.1" height="0.15" depth="20" color="#8b7355"></a-box>

        <a-box position="10 2.5 0" width="0.3" height="5" depth="20" color="#e8dcc7" roughness="0.6" shadow></a-box>
        <!-- Moldura parede direita -->
        <a-box position="9.85 4.8 0" width="0.1" height="0.15" depth="20" color="#8b7355"></a-box>

        <!-- Pinturas Decorativas -->
        <a-entity id="paintings-container">
            <!-- Quadro 1: ISS -->
            <a-box position="-9.85 2.2 0" rotation="0 90 0" width="1.8" height="2.2" depth="0.1" color="#4a2c2a"
                roughness="0.4"></a-box>
            <a-box class="clickable painting" data-painting-pos="-7 0 -7" position="-9.79 2.2 0" width="1.5"
                rotation="0 90 0" height="1.9" depth="0.05" src="/images/iss.jpg" roughness="0.8"
                metalness="0.5"></a-box>

            <!-- Quadro 2: Hubble -->
            <a-box position="-5 2.2 -9.85" width="1.8" height="2.2" depth="0.1" color="#1a4d6d" roughness="0.4"></a-box>
            <a-box class="clickable painting" data-painting-pos="-3.5 0 -7" position="-5 2.2 -9.79" width="1.5"
                height="1.9" depth="0.05" src="/images/hubble.jpg" roughness="0.8" metalness="0.5"></a-box>

            <!-- Quadro 3: JWST -->
            <a-box position="0 2.2 -9.85" width="1.8" height="2.2" depth="0.1" color="#8b5a00" roughness="0.4"></a-box>
            <a-box class="clickable painting" data-painting-pos="0 0 -7" position="0 2.2 -9.79" width="1.5" height="1.9"
                depth="0.05" src="/images/jwst.jpg" roughness="0.8" metalness="0.5"></a-box>
            <!-- Quadro 4: saturnV -->
            <a-box position="5 2.2 -9.85" width="1.8" height="2.2" depth="0.1" color="#1e5631" roughness="0.4"></a-box>
            <a-box class="clickable painting" data-painting-pos="3.5 0 -7" position="5 2.2 -9.79" width="1.5"
                height="1.9" depth="0.05" src="/images/saturnV.jpg" roughness="0.8" metalness="0.5"></a-box>

            <!-- Quadro 5: Voyager -->
            <a-box position="9.85 2.2 0" width="1.8" height="2.2" depth="0.1" color="#5b2c6f" rotation="0 90 0"
                roughness="0.4"></a-box>
            <a-box class="clickable painting" data-painting-pos="7 0 -7" position="9.79  2.2 0" width="1.5"
                rotation="0 90 0" height="1.9" depth="0.05" src="/images/voyager.jpg" roughness="0.8"
                metalness="0.5"></a-box>
        </a-entity>

        <!-- Exibi√ß√µes  -->
        <a-entity id="exhibits-container">
            <!-- Hubble -->
            <a-entity id="hubble" position="-5 0 -5">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4"
                    rotation="0 -45 0"></a-box>
                <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50" roughness="0.3"
                    rotation="0 -45 0"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2"
                    metalness="0.3" rotation="0 -45 0"></a-box>

                <a-entity gltf-model="#hubble-model" position="0 2 0" scale="0.0003 0.0003 0.0003"
                    class="clickable exhibit-model" data-exhibit-id="hubble" cursor-hover
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"></a-entity>

                <a-entity position="0.425 0.2 0.450" rotation="0 45 0">
                    <a-plane position="0 0 0" width="1" height="0.3" color="#ecf0f1" roughness="0.4"></a-plane>
                    <a-text value="üî≠ Hubble" position="0 0 0" align="center" anchor="center" color="#2c3e50"></a-text>
                </a-entity>

                <a-entity position="0.5 0.7 0.52">
                    <a-image src="#hotspot-img" class="clickable" data-triggerable-button="1" billboard=""
                        scale="0.5 0.5 0.5" material="" geometry="" rotation="0 45 0"></a-image>
                    <a-entity id="infoPanelContainer1"></a-entity>
                </a-entity>
            </a-entity>

            <!-- JWST -->
            <a-entity position="0 0 -5">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4"
                    shadow></a-box>
                <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50"
                    roughness="0.3"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2"
                    metalness="0.3"></a-box>

                <a-entity gltf-model="#jwst-model" position="0 2 0" scale="0.05 0.05 0.05"
                    class="clickable exhibit-model" data-exhibit-id="jwst" cursor-hover
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"></a-entity>

                <a-plane position="0 0.2 0.61" width="1" height="0.3" color="#ecf0f1" roughness="0.4"></a-plane>
                <a-text value="JWST" position="0 0.2 0.61" align="center" anchor="center" color="#2c3e50"></a-text>
            </a-entity>

            <!-- Saturn V -->
            <a-entity position="5 0 -5">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4"
                    rotation="0 45 0"></a-box>
                <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50" roughness="0.3"
                    rotation="0 45 0"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2"
                    metalness="0.3" rotation="0 45 0"></a-box>

                <a-entity gltf-model="#saturnv-model" position="0 2 0" scale="0.2 0.2 0.2"
                    class="clickable exhibit-model" data-exhibit-id="saturnv" cursor-hover
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"></a-entity>

                <a-entity rotation="0 -45 0">
                    <a-plane position="0 0.2 0.61" width="1" height="0.3" color="#ecf0f1" roughness="0.4"></a-plane>
                    <a-text value="üöÄ Saturn V" position="0 0.2 0.61" align="center" anchor="center"
                        color="#2c3e50"></a-text>
                </a-entity>
            </a-entity>

            <!-- ISS -->
            <a-entity position="-5 0 0">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4"
                    shadow></a-box>
                <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50"
                    roughness="0.3"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2"
                    metalness="0.3"></a-box>

                <a-entity gltf-model="#iss-model" position="0 2 0" scale="0.1 0.1 0.1" class="clickable exhibit-model"
                    data-exhibit-id="iss" cursor-hover
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"></a-entity>

                <a-plane position="0.61 0.2 0" width="1" height="0.3" color="#ecf0f1" roughness="0.4"
                    rotation="0 90 0"></a-plane>
                <a-text value="üåç ISS" position="0.61 0.2 0" align="center" anchor="center" color="#2c3e50"
                    rotation="0 90 0"></a-text>
            </a-entity>

            <!-- Voyager -->
            <a-entity position="5 0 0">
                <a-box position="0 0.5 0" width="1.2" height="1" depth="1.2" color="#34495e" roughness="0.4"
                    shadow></a-box>
                <a-box position="0 1.05 0" width="1.25" height="0.1" depth="1.25" color="#2c3e50"
                    roughness="0.3"></a-box>
                <a-box position="0 1.2 0" width="1" height="0.15" depth="1" color="#5d6d7e" roughness="0.2"
                    metalness="0.3"></a-box>

                <a-entity gltf-model="#voyager-model" position="0 2 0" scale="0.15 0.15 0.15"
                    class="clickable exhibit-model" data-exhibit-id="voyager" rotation="0 0 45" cursor-hover
                    animation="property: rotation; to: 0 360 45; loop: true; dur: 10000; easing: linear"></a-entity>

                <a-plane position="-0.61 0.2 0" width="1" height="0.3" color="#ecf0f1" roughness="0.4"
                    rotation="0 -90 0"></a-plane>
                <a-text value="üõ∞Ô∏è Voyager" position="-0.61 0.2 0" align="center" anchor="center" color="#2c3e50"
                    rotation="0 -90 0"></a-text>

                <a-entity position="-0.8 0.7 0.030" rotation="0 -90 0">
                    <a-image src="#hotspot-img" class="clickable" data-triggerable-button="2" billboard
                        scale="0.5 0.5 0.5"></a-image>
                    <a-entity id="infoPanelContainer2"></a-entity>
                </a-entity>

            </a-entity>
        </a-entity>
        </a-entity>




        </a-entity>
    </a-scene>

    <script>
        // L√≥gica de funcionamento dos Hotspots
        window.onload = function () {

            const buttons = document.querySelectorAll("[data-triggerable-button]");

            buttons.forEach((btn) => {
                const openPanel = function () {
                    const id = btn.getAttribute("data-triggerable-button");
                    const template = document.querySelector(`#infoPanel${id}`);
                    const container = btn.nextElementSibling;

                    hideAllInfoPanels();

                    const clone = document.importNode(template.content, true);
                    container.appendChild(clone);

                    btn.setAttribute("visible", false);

                    setTimeout(() => {
                        const closeBtn = container.querySelector("#close-btn");
                        if (closeBtn) {
                            closeBtn.addEventListener("click", (e) => {
                                e.stopPropagation();
                                hideAllInfoPanels();
                            });
                        }

                        // Bot√£o para ir √† cena 2 (Galeria)
                        const viewBtn = container.querySelector("[id^='view-']");
                        if (viewBtn) {
                            viewBtn.addEventListener("click", (e) => {
                                e.stopPropagation();
                                const modelType = viewBtn.id.replace('view-', '').replace('-btn', '');
                                navegarParaCena2(modelType);
                            });
                        }
                    }, 100);
                };

                btn.addEventListener("click", openPanel);
                btn.addEventListener("mousedown", openPanel);
            });
        };

        function navegarParaCena2(modelType) {
            // Map com escala e rota√ß√£o de cada modelo
            const modelConfigs = {
                'hubble': {
                    scale: '0.0005 0.0005 0.0005',
                    rotation: '0 0 0'
                },
                'jwst': {
                    scale: '0.05 0.05 0.05',
                    rotation: '0 0 0'
                },
                'saturnv': {
                    scale: '0.2 0.2 0.2',
                    rotation: '0 0 0'
                },
                'iss': {
                    scale: '0.1 0.1 0.1',
                    rotation: '0 0 0'
                },
                'voyager': {
                    scale: '0.15 0.15 0.15',
                    // rotation: '0 0 45'
                    rotation: '0 0 45'
                }
            };

            // Armazena a informa√ß√£o no sessionStorage
            sessionStorage.setItem('modeloExibicao', modelType);
            sessionStorage.setItem('modeloConfig', JSON.stringify(modelConfigs[modelType]));

            // Aplica fade out
            document.body.style.opacity = '0';

            setTimeout(() => {
                window.location.href = 'index-simples02.html';
            }, 500);
        }
    </script>
</body>

</html>